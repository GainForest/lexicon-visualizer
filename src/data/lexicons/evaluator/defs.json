{
  "lexicon": 1,
  "id": "app.gainforest.evaluator.defs",
  "description": "Shared type definitions for decentralized evaluator services.",
  "defs": {
    "subjectRef": {
      "type": "object",
      "description": "Reference to a target record that is being evaluated.",
      "required": ["uri"],
      "properties": {
        "uri": { "type": "string", "format": "at-uri", "description": "AT-URI of the target record." },
        "cid": { "type": "string", "format": "cid", "description": "CID pinning the exact version of the target record." }
      }
    },
    "methodInfo": {
      "type": "object",
      "description": "Provenance metadata describing the method used to produce an evaluation.",
      "required": ["name"],
      "properties": {
        "name": { "type": "string", "maxGraphemes": 256, "description": "Human-readable name of the method or model." },
        "version": { "type": "string", "maxGraphemes": 64, "description": "Version string of the method or model." },
        "modelCheckpoint": { "type": "string", "maxGraphemes": 128, "description": "Identifier for the specific model checkpoint used." },
        "references": { "type": "array", "items": { "type": "string", "format": "uri" }, "maxLength": 10, "description": "URIs to papers, documentation, or repositories." }
      }
    },
    "candidateTaxon": {
      "type": "object",
      "description": "A candidate taxon identification with confidence score and rank.",
      "required": ["scientificName", "confidence", "rank"],
      "properties": {
        "scientificName": { "type": "string", "maxGraphemes": 512, "description": "Full scientific name of the candidate taxon." },
        "gbifTaxonKey": { "type": "string", "maxGraphemes": 64, "description": "GBIF backbone taxonomy key for the candidate." },
        "confidence": { "type": "integer", "minimum": 0, "maximum": 1000, "description": "Confidence score (0-1000, where 1000 = 100.0%)." },
        "rank": { "type": "integer", "minimum": 1, "description": "Rank position among candidates (1 = best match)." },
        "kingdom": { "type": "string", "maxGraphemes": 128, "description": "Kingdom of the candidate taxon." },
        "family": { "type": "string", "maxGraphemes": 128, "description": "Family of the candidate taxon." },
        "genus": { "type": "string", "maxGraphemes": 128, "description": "Genus of the candidate taxon." }
      }
    },
    "qualityFlag": {
      "type": "object",
      "description": "A single data quality flag indicating an issue with a specific field.",
      "required": ["field", "issue"],
      "properties": {
        "field": { "type": "string", "maxGraphemes": 64, "description": "The field name that has the quality issue." },
        "issue": { "type": "string", "maxGraphemes": 256, "description": "Description of the quality issue." },
        "severity": { "type": "string", "maxGraphemes": 64, "knownValues": ["error","warning","info"], "description": "Severity level of the quality issue." }
      }
    },
    "speciesIdResult": {
      "type": "object",
      "description": "AI or human species recognition result with ranked candidate identifications.",
      "required": ["candidates"],
      "properties": {
        "candidates": { "type": "array", "items": { "type": "ref", "ref": "#candidateTaxon" }, "maxLength": 20, "description": "Ranked list of candidate species identifications." },
        "inputFeature": { "type": "string", "maxGraphemes": 64, "description": "Which feature of the subject record was used as input." },
        "remarks": { "type": "string", "maxGraphemes": 2048, "description": "Additional notes about the species identification." }
      }
    },
    "bioacousticsResult": {
      "type": "object",
      "description": "Result of audio-based species detection.",
      "required": ["detections"],
      "properties": {
        "detections": { "type": "array", "items": { "type": "ref", "ref": "#bioacousticsDetection" }, "maxLength": 100, "description": "Detected species/sounds within the audio recording." },
        "totalDurationAnalyzedSeconds": { "type": "string", "maxGraphemes": 32, "description": "Total audio duration analyzed in seconds." },
        "soundscapeIndex": { "type": "string", "maxGraphemes": 32, "description": "Acoustic diversity index value." },
        "remarks": { "type": "string", "maxGraphemes": 2048, "description": "Additional notes about the bioacoustics analysis." }
      }
    },
    "deforestationResult": {
      "type": "object",
      "description": "Deforestation/land-use change detection result.",
      "required": ["changeType"],
      "properties": {
        "changeType": { "type": "string", "maxGraphemes": 64, "knownValues": ["deforestation","degradation","reforestation","afforestation","no-change","fire","flooding","urbanization"], "description": "Type of land-use change detected." },
        "areaAffectedHectares": { "type": "string", "maxGraphemes": 32, "description": "Area affected by the change in hectares." },
        "changePercentage": { "type": "string", "maxGraphemes": 16, "description": "Percentage of monitored area affected." },
        "satelliteSource": { "type": "string", "maxGraphemes": 128, "description": "Satellite data source." },
        "remarks": { "type": "string", "maxGraphemes": 2048, "description": "Additional notes about the deforestation detection." }
      }
    },
    "carbonEstimationResult": {
      "type": "object",
      "description": "Carbon stock or sequestration estimation.",
      "required": ["estimationType", "value", "unit"],
      "properties": {
        "estimationType": { "type": "string", "maxGraphemes": 64, "knownValues": ["above-ground-biomass","below-ground-biomass","soil-carbon","total-carbon-stock","annual-sequestration","avoided-emissions"], "description": "Type of carbon estimation." },
        "value": { "type": "string", "maxGraphemes": 32, "description": "Estimated carbon value." },
        "unit": { "type": "string", "maxGraphemes": 32, "description": "Unit of the estimated value." },
        "uncertainty": { "type": "string", "maxGraphemes": 32, "description": "Uncertainty range." },
        "methodology": { "type": "string", "maxGraphemes": 512, "description": "Estimation methodology used." },
        "remarks": { "type": "string", "maxGraphemes": 2048, "description": "Additional notes about the carbon estimation." }
      }
    }
  }
}
